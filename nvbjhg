import express from "express";
import cors from "cors";
import dotenv from "dotenv";
import { MongoClient } from "mongodb";

const app = express();
app.listen(process.env.PORT, async (err) => {
    await dbConnect();
    console.log("Started server ");
    if (err) {
      console.log(err, "error in starting server");
    }
});
//const MONGO_URL = "mongodb://localhost";

const MONGO_URL = process.env.MONGO_URL;
//mongodb+srv://dhanya:<password>@cluster0.5vqmt.mongodb.net/myFirstDatabase?retryWrites=true&w=majority

async function CreateConnection(){
  const client = new MongoClient(MONGO_URL);
  await client.connect();
  console.log(" mongo connected");
  return client;
}
export const client = await CreateConnection();

const { dbConnect } = require("./mongo/mongo");
const studentRoute = require("./routes/student");
const mentorRoute = require("./routes/mentor");
const assignMentortoStudent = require("./routes/assignMentortoStudent");


app.use(cors());
app.use(express.json());
app.use(express.urlencoded({ extended: false }));

app.get("/", (req, res) => {
  res.send("Working fine...");
});
app.use("/student", studentRoute);
app.use("/mentor", mentorRoute);
app.use("/assignmentor", assignMentortoStudent);

